{% extends "navbar.html" %}
{% load static %}

{% block content %}
    <link rel="stylesheet" href="{% static '/css/account.css' %}">
    <script src="{% static '/js/account.js' %}" defer></script>
    <div class="layout">
        <div class="info">
            <div>
                <h1>{{ request.user }} - Cleaner</h1>
                <!-- Change Password Button -->
                <button onclick="openPModel()"
                        style="background: #007bff; color: white; padding: 10px; border: none; cursor: pointer; border-radius: 5px;">
                    Change Password
                </button>
            </div>

            <!-- Password Change Popup Model -->
            <div id="passwordModel" class="model">
                <div class="model-content">
                    <span class="close" onclick="closePModel()">&times;</span>
                    <h2>Change Password</h2>
                    <form action="{% url 'password_change' %}" method="post">
                        {% csrf_token %}
                        <label>Old Password:</label>
                        <input type="password" name="old_password" placeholder="Enter old password" required>

                        <label>New Password:</label>
                        <input type="password" name="new_password1" placeholder="Enter new password" required>

                        <label>Confirm Password:</label>
                        <input type="password" name="new_password2" placeholder="confirm new password" required>

                        <button type="submit">Change Password</button>
                    </form>
                </div>
            </div>

            <div>
                <p class="stars">
                    {% for i in "12345"|make_list %}
                        {% if forloop.counter <= user.rating %}
                            ★
                        {% else %}
                            ☆
                        {% endif %}
                    {% endfor %}
                </p>
                <p>Email: {{ request.email }}</p>
                <button onclick="openEModel()"
                    style="background: #007bff; color: white; padding: 10px; border: none; cursor: pointer; border-radius: 5px;">
                    Change Email
                </button>
            </div>
            <!-- Email Change Popup Model -->
            <div id="emailModel" class="model">
                <div class="model-content">
                    <span class="close" onclick="closeEModel()">&times;</span>
                    <h2>Change Email</h2>
                    <form action="{% url 'email_change' %}" method="post">
                        {% csrf_token %}
                        <label>New Email:</label>
                        <input type="email" name="new email" placeholder="Enter new email" required>
                        <label>Password:</label>
                        <input type="password" name="password" placeholder="Enter password" required>
                        <button type="submit">Change Email</button>
                    </form>
                </div>
            </div>
            <div>
                <p>Phone: {{ request.phone }}</p>
                <p>Suburb: {{ request.suburb }}</p>
            </div>
        </div>


        <div class="timetable">
            <h1>Timetable</h1>
        </div>
    </div>



    <script>
        function openPModel() {
            document.getElementById("passwordModel").style.display = "flex";
        }

        function closePModel() {
            document.getElementById("passwordModel").style.display = "none";
        }
        function openEModel() {
            document.getElementById("emailModel").style.display = "flex";
        }

        function closeEModel() {
            document.getElementById("emailModel").style.display = "none";
        }
    </script>

{% endblock content %}